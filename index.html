<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viral 3D Script Generator - GROQ</title>

<style>
body{
    margin:0;
    background:#0f1117;
    font-family:Segoe UI, sans-serif;
    color:white;
}
.container{
    max-width:1000px;
    margin:auto;
    padding:20px;
}
h1{
    text-align:center;
    font-weight:600;
}
input{
    width:100%;
    padding:10px;
    border-radius:6px;
    border:none;
    margin-top:5px;
    background:#1a1d29;
    color:white;
}
button{
    background:#00b894;
    border:none;
    padding:10px 16px;
    color:white;
    border-radius:6px;
    cursor:pointer;
    margin-top:10px;
}
button:hover{
    opacity:0.9;
}
.idea{
    background:#1a1d29;
    padding:12px;
    margin:8px 0;
    border-radius:6px;
    cursor:pointer;
}
.idea:hover{
    background:#22263a;
}
.box{
    background:#1a1d29;
    padding:15px;
    border-radius:8px;
    margin-top:20px;
}
.scene{
    background:#22263a;
    padding:15px;
    border-radius:8px;
    margin-top:15px;
}
textarea{
    width:100%;
    background:#0f1117;
    color:white;
    border:1px solid #333;
    border-radius:6px;
    padding:10px;
    resize:none;
}
.copy-btn{
    background:#5865f2;
    margin-top:5px;
}
.loading{
    text-align:center;
    margin-top:15px;
    font-weight:bold;
}
.error{
    background:#ff4757;
    padding:10px;
    border-radius:6px;
    margin-top:10px;
}
</style>
</head>

<body>

<div class="container">

<h1>Viral YouTube 3D Script Generator (GROQ)</h1>

<label>Masukkan GROQ API Key:</label>
<input type="password" id="apiKey" placeholder="gsk_...">

<button onclick="generateIdeas()">Generate 10 Ide Viral</button>

<div id="ideas"></div>
<div id="scriptSection"></div>
<div id="errorPanel"></div>

</div>

<script>

const MASTER_PROMPT = `
Anda adalah Penulis Naskah Viral YouTube yang berspesialisasi dalam simulasi "Bagaimana jika" "Berapa lama kamu bisa" "Apa yang terjadi jika kamu" yang sangat realistis.

WAJIB konsisten visual:
Ultra-realistic cinematic 3D render dari sosok kerangka humanoid dengan lapisan tubuh transparan seperti kristal/gelas menutupi tulang tengkorak anatomi yang jelas dengan gigi terlihat dan memiliki bola mata tampilan semi-x-ray realitas edukatif dan surealis, tidak menakutkan bukan kartun detail ultra tinggi fokus tajam 8K

Struktur WAJIB:

NARASI:
(paragraf 45-60 detik dengan eskalasi progresif)

SCENE 1 IMAGE:
...

SCENE 1 VIDEO:
...

SCENE 2 IMAGE:
...

SCENE 2 VIDEO:
...
`;

function showError(msg){
    document.getElementById("errorPanel").innerHTML =
        `<div class="error">${msg}</div>`;
}

function clearError(){
    document.getElementById("errorPanel").innerHTML="";
}

async function generateIdeas(){
    clearError();
    const apiKey = document.getElementById("apiKey").value.trim();
    if(!apiKey){ showError("Masukkan GROQ API Key!"); return;}

    document.getElementById("ideas").innerHTML="<div class='loading'>Generating Ideas...</div>";

    try{
        const response = await fetch("https://api.groq.com/openai/v1/chat/completions",{
            method:"POST",
            headers:{
                "Content-Type":"application/json",
                "Authorization":"Bearer "+apiKey
            },
            body:JSON.stringify({
                model:"llama3-70b-8192",
                messages:[
                    {role:"system", content:MASTER_PROMPT},
                    {role:"user", content:"Buat 10 judul saja tanpa penjelasan."}
                ],
                temperature:0.9
            })
        });

        if(!response.ok){
            const errText = await response.text();
            showError(errText);
            document.getElementById("ideas").innerHTML="";
            return;
        }

        const data = await response.json();
        const text = data.choices[0].message.content;

        const lines = text.split("\n").filter(l=>l.trim()!="");

        document.getElementById("ideas").innerHTML="<h3>Pilih Judul:</h3>";

        lines.forEach(line=>{
            const clean=line.replace(/^\d+[\.\-]\s*/,"");
            const div=document.createElement("div");
            div.className="idea";
            div.innerText=clean;
            div.onclick=()=>generateScript(clean);
            document.getElementById("ideas").appendChild(div);
        });

    }catch(err){
        showError(err.message);
    }
}

async function generateScript(title){
    clearError();
    const apiKey = document.getElementById("apiKey").value.trim();

    document.getElementById("scriptSection").innerHTML="<div class='loading'>Generating Script...</div>";

    try{
        const response = await fetch("https://api.groq.com/openai/v1/chat/completions",{
            method:"POST",
            headers:{
                "Content-Type":"application/json",
                "Authorization":"Bearer "+apiKey
            },
            body:JSON.stringify({
                model:"llama3-70b-8192",
                messages:[
                    {role:"system", content:MASTER_PROMPT},
                    {role:"user", content:`Judul: ${title}`}
                ],
                temperature:0.8
            })
        });

        if(!response.ok){
            const errText = await response.text();
            showError(errText);
            document.getElementById("scriptSection").innerHTML="";
            return;
        }

        const data = await response.json();
        const text = data.choices[0].message.content;

        renderScript(text);
        window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"});

    }catch(err){
        showError(err.message);
    }
}

function renderScript(text){

    const narasiMatch=text.match(/NARASI:(.*?)(SCENE 1 IMAGE:)/s);
    const narasi=narasiMatch?narasiMatch[1].trim():"Narasi tidak ditemukan";

    let scenes=[];
    const regex=/SCENE (\d+) IMAGE:(.*?)SCENE \1 VIDEO:(.*?)(?=SCENE \d+ IMAGE:|$)/gs;
    let match;
    while((match=regex.exec(text))!==null){
        scenes.push({
            num:match[1],
            image:match[2].trim(),
            video:match[3].trim()
        });
    }

    let html=`
    <div class="box">
        <h2>NARASI</h2>
        <textarea readonly rows="8">${narasi}</textarea>
        <button class="copy-btn" onclick="copyText(\`${narasi}\`)">Copy Narasi</button>
    </div>
    <div class="box">
        <h2>PROMPT PER SCENE</h2>
    `;

    scenes.forEach(scene=>{
        html+=`
        <div class="scene">
            <h3>Scene ${scene.num}</h3>

            <b>Image Prompt</b>
            <textarea readonly rows="5">${scene.image}</textarea>
            <button class="copy-btn" onclick="copyText(\`${scene.image}\`)">Copy Image</button>

            <br><br>

            <b>Video Prompt</b>
            <textarea readonly rows="5">${scene.video}</textarea>
            <button class="copy-btn" onclick="copyText(\`${scene.video}\`)">Copy Video</button>
        </div>
        `;
    });

    html+="</div>";
    document.getElementById("scriptSection").innerHTML=html;
}

function copyText(text){
    navigator.clipboard.writeText(text);
    alert("Copied!");
}

</script>

</body>
</html>
