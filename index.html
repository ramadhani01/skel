<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>YouTube Shorts AI Generator</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#0f172a;
    color:white;
}
.container{
    max-width:900px;
    margin:auto;
    padding:20px;
}
h1{
    text-align:center;
    color:#38bdf8;
}
.card{
    background:#1e293b;
    padding:20px;
    border-radius:12px;
    margin-bottom:20px;
}
input, textarea{
    width:100%;
    padding:10px;
    border-radius:8px;
    border:none;
    margin-top:10px;
    margin-bottom:10px;
    font-size:14px;
}
button{
    background:#38bdf8;
    color:black;
    padding:10px 15px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
}
button:hover{
    opacity:0.8;
}
.idea{
    background:#334155;
    padding:10px;
    border-radius:8px;
    margin-bottom:10px;
    cursor:pointer;
}
.idea:hover{
    background:#475569;
}
#result{
    white-space:pre-line;
    background:#0f172a;
    padding:15px;
    border-radius:8px;
    border:1px solid #334155;
}
.error{
    color:red;
}
</style>
</head>

<body>
<div class="container">

<h1>ðŸ”¥ AI YouTube Shorts Generator</h1>

<div class="card">
<label>Masukkan GROQ API Key</label>
<input type="password" id="apiKey" placeholder="Masukkan API Key Groq"/>
<button onclick="saveKey()">Simpan Key</button>
</div>

<div class="card">
<label>Masukkan Topik</label>
<input type="text" id="topic" placeholder="Contoh: Jika manusia tidak tidur"/>
<button onclick="generateIdeas()">Generate Ide</button>
</div>

<div class="card">
<h3>Ide Video</h3>
<div id="ideas"></div>
</div>

<div class="card">
<h3>Script 45-70 Detik</h3>
<div id="result"></div>
</div>

<div id="error" class="error"></div>

</div>

<script>

window.onload = function(){
    const savedKey = localStorage.getItem("GROQ_API_KEY");
    if(savedKey){
        document.getElementById("apiKey").value = savedKey;
    }
}

function saveKey(){
    const key = document.getElementById("apiKey").value;
    localStorage.setItem("GROQ_API_KEY", key);
    alert("API Key berhasil disimpan!");
}

function showError(msg){
    document.getElementById("error").innerText = msg;
}

async function callGroq(prompt){
    const apiKey = localStorage.getItem("GROQ_API_KEY");
    if(!apiKey){
        showError("API Key belum disimpan!");
        return null;
    }

    const response = await fetch("https://api.groq.com/openai/v1/responses",{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "Authorization":"Bearer " + apiKey
        },
        body: JSON.stringify({
            model: "openai/gpt-oss-20b",
            input: prompt
        })
    });

    const data = await response.json();

    let text = "";

    if(data.output){
        data.output.forEach(item=>{
            if(item.content){
                item.content.forEach(part=>{
                    if(part.type==="output_text"){
                        text += part.text;
                    }
                });
            }
        });
    }

    return text;
}

async function generateIdeas(){
    showError("");
    document.getElementById("ideas").innerHTML="Loading...";

    const topic = document.getElementById("topic").value;

    const prompt = `
Buatkan 5 ide video YouTube Shorts gaya:
"Apa yang terjadi jika..."
Format hanya daftar ide.
Topik utama: ${topic}
`;

    const text = await callGroq(prompt);

    if(!text){
        showError("Gagal generate ide.");
        return;
    }

    const lines = text.split("\n").filter(l=>l.trim()!="");

    const ideasDiv = document.getElementById("ideas");
    ideasDiv.innerHTML="";

    lines.forEach(line=>{
        const div = document.createElement("div");
        div.className="idea";
        div.innerText=line;
        div.onclick=()=>generateScript(line);
        ideasDiv.appendChild(div);
    });
}

async function generateScript(idea){
    showError("");
    document.getElementById("result").innerText="Generating script...";

    const prompt = `
Buat narasi YouTube Shorts durasi 45-70 detik.
Format WAJIB:

Baris pertama = JUDUL
Lalu progresi waktu dengan format:
"Selama X detik/menit/jam..."

Gaya edukatif anatomi 3D.
Jangan lebih dari 70 detik.

Topik: ${idea}
`;

    const text = await callGroq(prompt);

    if(!text){
        showError("Gagal generate script.");
        return;
    }

    document.getElementById("result").innerText = text;
}

</script>

</body>
</html>
