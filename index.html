<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viral Script Generator 3D</title>
<style>
body{
    background:#0f1117;
    font-family:Arial, sans-serif;
    color:#fff;
    margin:0;
    padding:20px;
}
h1{
    text-align:center;
    font-size:28px;
}
.container{
    max-width:900px;
    margin:auto;
}
button{
    background:#5865f2;
    border:none;
    padding:10px 15px;
    color:white;
    border-radius:6px;
    cursor:pointer;
    margin-top:10px;
}
button:hover{
    background:#4752c4;
}
.idea{
    background:#1a1d29;
    padding:10px;
    border-radius:6px;
    margin:6px 0;
    cursor:pointer;
}
.idea:hover{
    background:#22263a;
}
.box{
    background:#1a1d29;
    padding:15px;
    border-radius:8px;
    margin-top:20px;
}
.scene{
    background:#22263a;
    padding:12px;
    border-radius:6px;
    margin-top:15px;
}
.copy-btn{
    background:#00b894;
    margin-top:5px;
}
textarea{
    width:100%;
    height:120px;
    background:#0f1117;
    color:white;
    border:1px solid #333;
    border-radius:6px;
    padding:10px;
    resize:none;
}
</style>
</head>
<body>

<div class="container">

<h1>Viral YouTube Script Generator 3D</h1>

<label>Masukkan API Key:</label>
<input type="password" id="apiKey" style="width:100%;padding:8px;border-radius:6px;border:none;margin-top:5px;">

<br>
<button onclick="generateIdeas()">Generate 10 Ide Viral</button>

<div id="ideas"></div>

<div id="scriptSection"></div>

</div>

<script>

const MASTER_PROMPT = `
Anda adalah Penulis Naskah Viral YouTube yang berspesialisasi dalam simulasi "Bagaimana jika" "Berapa lama kamu bisa" "Apa yang terjadi jika kamu" yang sangat realistis (gaya: Animasi anatomi 3D seperti Perbandingan atau Skenario Tubuh Manusia).

Petunjuk:
- Tetap penasaran namun mendidik
- Terminologi visual HARUS konsisten:
"Ultra-realistic cinematic 3D render dari sosok kerangka humanoid dengan lapisan tubuh transparan seperti kristal/gelas menutupi tulang tengkorak anatomi yang jelas dengan gigi terlihat dan memiliki bola mata tampilan semi-x-ray realitas edukatif dan surealis, tidak menakutkan bukan kartun detail ultra tinggi fokus tajam 8K"
- Fokus retensi tinggi
`;

async function generateIdeas(){
    const apiKey = document.getElementById("apiKey").value;
    if(!apiKey){ alert("Masukkan API Key dulu"); return;}

    document.getElementById("ideas").innerHTML="Generating...";

    const response = await fetch("https://api.openai.com/v1/chat/completions",{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "Authorization":"Bearer "+apiKey
        },
        body:JSON.stringify({
            model:"gpt-4o-mini",
            messages:[
                {role:"system", content:MASTER_PROMPT},
                {role:"user", content:"Buat 10 ide judul saja tanpa penjelasan."}
            ]
        })
    });

    const data = await response.json();
    const text = data.choices[0].message.content;

    const lines = text.split("\n").filter(l=>l.trim()!="");

    document.getElementById("ideas").innerHTML = "<h3>Pilih Judul:</h3>";
    lines.forEach(line=>{
        const div = document.createElement("div");
        div.className="idea";
        div.innerText=line.replace(/^\d+[\.\-]\s*/,"");
        div.onclick=()=>generateScript(div.innerText);
        document.getElementById("ideas").appendChild(div);
    });
}

async function generateScript(title){
    const apiKey = document.getElementById("apiKey").value;

    document.getElementById("scriptSection").innerHTML="Generating Script...";

    const response = await fetch("https://api.openai.com/v1/chat/completions",{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "Authorization":"Bearer "+apiKey
        },
        body:JSON.stringify({
            model:"gpt-4o-mini",
            messages:[
                {role:"system", content:MASTER_PROMPT},
                {role:"user", content:`
Buat naskah 45-60 detik dalam format paragraf dengan eskalasi progresif.
Pisahkan output menjadi:
NARASI:
SCENE 1 IMAGE:
SCENE 1 VIDEO:
SCENE 2 IMAGE:
SCENE 2 VIDEO:
dan seterusnya.

Judul: ${title}
`}
            ]
        })
    });

    const data = await response.json();
    const text = data.choices[0].message.content;

    renderScript(text);

    window.scrollTo({top:document.body.scrollHeight, behavior:"smooth"});
}

function renderScript(text){

    const narasiMatch = text.match(/NARASI:(.*?)(SCENE 1 IMAGE:)/s);
    const narasi = narasiMatch ? narasiMatch[1].trim() : "Narasi tidak ditemukan.";

    let scenes = [];
    const sceneRegex = /SCENE (\d+) IMAGE:(.*?)SCENE \1 VIDEO:(.*?)(?=SCENE \d+ IMAGE:|$)/gs;
    let match;
    while((match = sceneRegex.exec(text))!==null){
        scenes.push({
            number:match[1],
            image:match[2].trim(),
            video:match[3].trim()
        });
    }

    let html = `
    <div class="box">
        <h2>NARASI</h2>
        <textarea readonly>${narasi}</textarea>
        <button class="copy-btn" onclick="copyText(\`${narasi}\`)">Copy Narasi</button>
    </div>
    `;

    html+=`<div class="box"><h2>PROMPT PER SCENE</h2>`;

    scenes.forEach(scene=>{
        html+=`
        <div class="scene">
            <h3>Scene ${scene.number}</h3>

            <b>Image Prompt</b>
            <textarea readonly>${scene.image}</textarea>
            <button class="copy-btn" onclick="copyText(\`${scene.image}\`)">Copy Image</button>

            <br><br>
            <b>Video Prompt</b>
            <textarea readonly>${scene.video}</textarea>
            <button class="copy-btn" onclick="copyText(\`${scene.video}\`)">Copy Video</button>
        </div>
        `;
    });

    html+="</div>";

    document.getElementById("scriptSection").innerHTML = html;
}

function copyText(text){
    navigator.clipboard.writeText(text);
    alert("Copied!");
}

</script>

</body>
</html>
